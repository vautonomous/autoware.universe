<launch>
  <arg name="show_debug_info" default="False"/>
  <arg name="enable_yaw_bias_estimation" default="False"/>
  <arg name="predict_frequency" default="50.0"/>
  <arg name="tf_rate" default="50.0"/>
  <arg name="extend_state_step" default="50"/>
  <arg name="input_initial_pose_name" default="initialpose"/>
  <!--  for Pose measurement  -->
  <arg name="input_pose_with_cov_name" default="gnss_pose_cov"/>
  <arg name="pose_additional_delay" default="0.0"/>
  <arg name="pose_measure_uncertainty_time" default="0.01"/>
  <arg name="pose_rate" default="50.0"/>
  <arg name="pose_gate_dist" default="10000.0"/>
  <!--  for twist measurement  -->
  <arg name="input_twist_with_cov_name" default="gyro_twist_with_covariance"/>
  <arg name="twist_additional_delay" default="0.0"/>
  <arg name="twist_rate" default="50.0"/>
  <arg name="twist_gate_dist" default="10000.0"/>
  <!--  for process model  -->
  <arg name="proc_stddev_yaw_c" default="0.005"/>
  <arg name="proc_stddev_yaw_bias_c" default="0.001"/>
  <arg name="proc_stddev_vx_c" default="2.0"/>
  <arg name="proc_stddev_wz_c" default="0.2"/>
  <!--  output topic name  -->
  <arg name="output_odom_name" default="ekf_odom"/>
  <arg name="output_pose_name" default="ekf_pose"/>
  <arg name="output_pose_with_covariance_name" default="ekf_pose_with_covariance"/>
  <arg name="output_pose_without_yawbias_name" default="ekf_pose_without_yawbias"/>
  <arg name="output_pose_with_covariance_without_yawbias_name" default="ekf_pose_with_covariance_without_yawbias"/>
  <arg name="output_twist_name" default="ekf_twist"/>
  <arg name="output_twist_with_covariance_name" default="ekf_twist_with_covariance"/>
  <node pkg="ekf_localizer" exec="ekf_localizer" name="ekf_localizer" output="screen">
    <remap from="in_pose_with_covariance" to="$(var input_pose_with_cov_name)"/>
    <remap from="in_twist_with_covariance" to="$(var input_twist_with_cov_name)"/>
    <remap from="initialpose" to="$(var input_initial_pose_name)"/>
    <param name="pose_frame_id" value="map"/>
    <param name="show_debug_info" value="$(var show_debug_info)"/>
    <param name="enable_yaw_bias_estimation" value="$(var enable_yaw_bias_estimation)"/>
    <param name="predict_frequency" value="$(var predict_frequency)"/>
    <param name="tf_rate" value="$(var tf_rate)"/>
    <param name="extend_state_step" value="$(var extend_state_step)"/>
    <param name="pose_additional_delay" value="$(var pose_additional_delay)"/>
    <param name="pose_measure_uncertainty_time" value="$(var pose_measure_uncertainty_time)"/>
    <param name="pose_rate" value="$(var pose_rate)"/>
    <param name="pose_gate_dist" value="$(var pose_gate_dist)"/>
    <param name="twist_additional_delay" value="$(var twist_additional_delay)"/>
    <param name="twist_rate" value="$(var twist_rate)"/>
    <param name="twist_gate_dist" value="$(var twist_gate_dist)"/>
    <param name="proc_stddev_yaw_c" value="$(var proc_stddev_yaw_c)"/>
    <param name="proc_stddev_yaw_bias_c" value="$(var proc_stddev_yaw_bias_c)"/>
    <param name="proc_stddev_vx_c" value="$(var proc_stddev_vx_c)"/>
    <param name="proc_stddev_wz_c" value="$(var proc_stddev_wz_c)"/>
    <remap from="ekf_odom" to="$(var output_odom_name)"/>
    <remap from="ekf_pose" to="$(var output_pose_name)"/>
    <remap from="ekf_pose_with_covariance" to="$(var output_pose_with_covariance_name)"/>
    <remap from="ekf_pose_without_yawbias" to="$(var output_pose_without_yawbias_name)"/>
    <remap from="ekf_pose_with_covariance_without_yawbias" to="$(var output_pose_with_covariance_without_yawbias_name)"/>
    <remap from="ekf_twist" to="$(var output_twist_name)"/>
    <remap from="ekf_twist_with_covariance" to="$(var output_twist_with_covariance_name)"/>
  </node>


  <!--  gnss_poser  -->
  <arg name="input_topic_fix" default="/fix"/>
  <arg name="input_topic_navpvt" default="/navpvt"/>
  <arg name="param_file" default="$(find-pkg-share gnss_poser)/config/set_local_origin.param.yaml"/>

  <arg name="output_topic_gnss_pose" default="gnss_pose"/>
  <arg name="output_topic_gnss_pose_cov" default="gnss_pose_cov"/>
  <arg name="output_topic_gnss_fixed" default="gnss_fixed"/>

  <arg name="base_frame" default="base_link"/>
  <arg name="gnss_base_frame" default="gnss_base_link"/>
  <arg name="gnss_frame" default="gnss"/>
  <arg name="map_frame" default="map"/>

  <arg name="coordinate_system" default="0" description="0:UTM, 1:MGRS, 2:PLANE, 3:LocalCartesian"/>
  <arg name="buff_epoch" default="1"/>
  <arg name="use_ublox_receiver" default="True"/>
  <arg name="plane_zone" default="9"/>

  <node pkg="gnss_poser" exec="gnss_poser" name="gnss_poser" output="screen">
    <remap from="fix" to="$(var input_topic_fix)"/>
    <remap from="navpvt" to="$(var input_topic_navpvt)"/>

    <remap from="gnss_pose" to="$(var output_topic_gnss_pose)"/>
    <remap from="gnss_pose_cov" to="$(var output_topic_gnss_pose_cov)"/>
    <remap from="gnss_fixed" to="$(var output_topic_gnss_fixed)"/>

    <param name="base_frame" value="$(var base_frame)"/>
    <param name="gnss_base_frame" value="$(var gnss_base_frame)"/>
    <param name="gnss_frame" value="$(var gnss_frame)"/>
    <param name="map_frame" value="$(var map_frame)"/>

    <param name="coordinate_system" value="$(var coordinate_system)"/>
    <param name="buff_epoch" value="$(var buff_epoch)"/>
    <param name="use_ublox_receiver" value="$(var use_ublox_receiver)"/>
    <param name="plane_zone" value="$(var plane_zone)"/>
    <param from="$(var param_file)"/>
  </node>


<!--  &lt;!&ndash;  gyro_odometer  &ndash;&gt;-->
<!--  <arg name="input_vehicle_twist_with_covariance_topic" default="/vehicle/status/twist_with_covariance" description="input twist with covariance topic name from vehicle"/>-->

<!--  <arg name="input_imu_topic" default="/sensing/imu/imu_data" description="input imu topic name"/>-->

<!--  <arg name="output_twist_raw_topic" default="gyro_twist_raw" description="output raw twist topic name"/>-->
<!--  <arg name="output_twist_with_covariance_raw_topic" default="gyro_twist_with_covariance_raw" description="output raw twist with covariance topic name"/>-->

<!--  <arg name="output_twist_topic" default="gyro_twist" description="output twist topic name"/>-->
<!--  <arg name="output_twist_with_covariance_topic" default="gyro_twist_with_covariance" description="output twist with covariance topic name"/>-->

<!--  <arg name="output_frame" default="base_link" description="output frame id"/>-->
<!--  <arg name="message_timeout_sec" default="0.2" description="delay tolerance time for message"/>-->

<!--  <node pkg="gyro_odometer" exec="gyro_odometer" name="gyro_odometer" output="screen">-->
<!--    <remap from="vehicle/twist_with_covariance" to="$(var input_vehicle_twist_with_covariance_topic)"/>-->

<!--    <remap from="imu" to="$(var input_imu_topic)"/>-->

<!--    <remap from="twist_raw" to="$(var output_twist_raw_topic)"/>-->
<!--    <remap from="twist_with_covariance_raw" to="$(var output_twist_with_covariance_raw_topic)"/>-->

<!--    <remap from="twist" to="$(var output_twist_topic)"/>-->
<!--    <remap from="twist_with_covariance" to="$(var output_twist_with_covariance_topic)"/>-->

<!--    <param name="output_frame" value="$(var output_frame)"/>-->
<!--    <param name="message_timeout_sec" value="$(var message_timeout_sec)"/>-->
<!--  </node>-->
</launch>
